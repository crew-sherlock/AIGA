name: chat_with_pdf
flow: inference

connections:
- name: aoai
  connection_type: AzureOpenAIConnection
  api_base: ${api_base}
  api_version: 2023-05-15
  api_key: ${api_key}
  api_type: azure

datasets:
- name: chat_with_pdf
  source: data/bert-paper-qna-1-line.jsonl
  description: "This dataset is for prompt experiments."
  mappings:
    question: "${data.question}"
    chat_history: "${data.chat_history}"
    deployment_name: "${data.CHAT_MODEL_DEPLOYMENT_NAME}"
    ai_search_endpoint: "${data.ai_search_endpoint}"

evaluators:
- name: chat_with_pdf_evaluation_flow
  flow: evaluation
  datasets:
  - name: chat_with_pdf_test
    reference: chat_with_pdf
    source: data/data.jsonl
    description: "This dataset is for evaluating flows."
    mappings:
      groundtruth: "${data.groundtruth}"
      prediction: "${run.outputs.answer}"
